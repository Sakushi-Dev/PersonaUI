<!-- Avatar Editor Overlay -->
<div id="avatar-editor-overlay" class="overlay hidden">
    <div class="overlay-content avatar-editor-content">
        <div class="overlay-header">
            <h2>Avatar auswählen</h2>
            <button class="close-btn" id="close-avatar-editor">&times;</button>
        </div>
        <div class="overlay-body">
            <!-- Step 1: Avatar Gallery -->
            <div id="avatar-selection-step" class="avatar-step active">
                <!-- Drop Zone für eigene Bilder -->
                <div class="avatar-drop-zone" id="avatar-drop-zone">
                    <div class="drop-zone-icon">
                        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                    </div>
                    <span class="drop-zone-text">Eigenes Bild hierher ziehen</span>
                    <span class="drop-zone-hint">oder klicken zum Auswählen</span>
                </div>
                <input type="file" id="file-input" accept=".png,.jpg,.jpeg,.webp" style="display: none;">
                
                <div class="avatar-gallery-divider">
                    <span>oder aus der Galerie wählen</span>
                </div>
                <div class="avatar-gallery" id="avatar-gallery">
                    <!-- Wird dynamisch mit JavaScript befüllt -->
                </div>
            </div>
            
            <!-- Step 2: Upload + Crop (nur bei Bild-Upload) -->
            <div id="avatar-upload-crop-step" class="avatar-step hidden">
                <h3>Bild zuschneiden:</h3>
                <div class="crop-upload-container">
                    <div class="crop-canvas-wrapper">
                        <canvas id="crop-canvas" width="500" height="500"></canvas>
                    </div>
                    <div class="crop-upload-controls">
                        <div class="crop-preview-circle">
                            <canvas id="crop-preview-canvas" width="200" height="200"></canvas>
                        </div>
                        <p class="crop-hint">Ziehe den Ausschnitt mit der Maus oder nutze das Mausrad zum Zoomen.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="overlay-footer">
            <button class="btn btn-secondary hidden" id="avatar-back-btn">Zurück</button>
            <button class="btn btn-primary hidden" id="avatar-save-btn">Speichern</button>
        </div>
    </div>
</div>
